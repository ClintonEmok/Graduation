---
phase: 13-ui-polish
plan: 03
type: execute
wave: 2
depends_on: [13-01, 13-02]
files_modified:
  - src/components/guide/Onboarding.tsx
  - src/components/layout/DashboardLayout.tsx
autonomous: true
user_setup: []
must_haves:
  truths:
    - "First-time user sees an onboarding tour"
    - "Tour highlights Map, Cube, and Controls"
    - "Tour marks itself as seen in localStorage"
  artifacts:
    - path: "src/components/guide/Onboarding.tsx"
      provides: "Driver.js wrapper component"
  key_links:
    - from: "src/components/layout/DashboardLayout.tsx"
      to: "src/components/guide/Onboarding.tsx"
      via: "Component mount"
---

<objective>
Implement an interactive onboarding tour for first-time users using driver.js.

Purpose: Guide users through the complex 3D/temporal interface elements.
Output: `OnboardingTour` component integrated into the dashboard.
</objective>

<execution_context>
@~/.opencode/get-shit-done/workflows/execute-plan.md
@~/.opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/13-ui-polish/13-RESEARCH.md
@src/components/layout/DashboardLayout.tsx
@src/components/viz/Controls.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install driver.js</name>
  <files>package.json</files>
  <action>
    Install `driver.js`:
    Run `npm install driver.js`
  </action>
  <verify>
    grep "driver.js" package.json
  </verify>
  <done>
    driver.js installed.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create Onboarding Component</name>
  <files>src/components/guide/Onboarding.tsx</files>
  <action>
    Create `src/components/guide/Onboarding.tsx`:
    1. Import `driver` from `driver.js` and CSS (`driver.js/dist/driver.css`).
    2. Define a `steps` array targeting IDs:
       - `#map-panel` (Left Map)
       - `#cube-panel` (3D Cube)
       - `#timeline-panel` (Bottom Timeline)
       - `#controls-panel` (Sidebar Controls)
       - `#settings-trigger` (Floating Toolbar)
    3. Use `useEffect` to check `localStorage.getItem('hasSeenOnboarding')`.
    4. If not seen:
       - Initialize driver.
       - `driverObj.drive()`.
       - Set localStorage on close/finish.
    5. Render `null` (it's a logic-only component that mounts the overlay).
  </action>
  <verify>
    Check file existence and logic.
  </verify>
  <done>
    Onboarding component created.
  </done>
</task>

<task type="auto">
  <name>Task 3: Integrate and ID Elements</name>
  <files>src/components/layout/DashboardLayout.tsx, src/components/viz/Controls.tsx</files>
  <action>
    1. In `DashboardLayout.tsx`:
       - Import `<OnboardingTour />`.
       - Mount it at the top level (e.g., inside the main div).
       - Add `id="map-panel"`, `id="cube-panel"`, `id="timeline-panel"` to the relevant layout divs (ResizablePanel components or their children).
    2. In `Controls.tsx` (or parent wrapper):
       - Ensure the container has `id="controls-panel"`.
    3. In `FloatingToolbar.tsx`:
       - Ensure the settings button has `id="settings-trigger"` (or similar).
  </action>
  <verify>
    grep "id=" src/components/layout/DashboardLayout.tsx
  </verify>
  <done>
    Layout elements have IDs and Tour is mounted.
  </done>
</task>

</tasks>

<verification>
- Run `npm run build`.
- Check that Onboarding component is mounted in Layout.
- Verify IDs match between Onboarding steps and Layout elements.
</verification>

<success_criteria>
- `driver.js` installed.
- `OnboardingTour` component created.
- IDs added to key UI regions.
- Tour integrated into DashboardLayout.
</success_criteria>

<output>
After completion, create `.planning/phases/13-ui-polish/13-03-SUMMARY.md`
</output>
