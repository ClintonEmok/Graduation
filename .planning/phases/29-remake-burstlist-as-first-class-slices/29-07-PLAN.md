---
phase: 29-remake-burstlist-as-first-class-slices
plan: 07
type: execute
wave: 1
depends_on:
  - phase: 29-06
    reason: SVG layering fix must be in place before auto-slice wiring
files_modified:
  - src/store/useSliceStore.ts
  - src/components/timeline/DualTimeline.tsx
  - src/components/viz/BurstList.tsx
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Burst windows automatically appear as slices without user interaction"
    - "Burst-derived slices are created automatically when bursts are computed/available"
    - "No click required to convert burst to slice"
    - "Burst list shows existing slices (not buttons to create them)"
    - "Timeline burst overlays represent existing slices (not click targets)"
    - "Burst slices still have isBurst flag and follow reuse logic if recomputed"
  artifacts:
    - path: "src/store/useSliceStore.ts"
      provides: "Automatic burst slice creation on burst data availability"
      changes:
        - "Add effect/hook to auto-create burst slices when bursts computed"
        - "Burst slices created with addBurstSlice logic (reuse if matching)"
        - "Remove manual click-to-create path from burst handlers"
    - path: "src/components/timeline/DualTimeline.tsx"
      provides: "Timeline showing burst slices without click-to-create"
      changes:
        - "Remove onClick handlers from burst overlay rects"
        - "Burst overlays become visual only (select existing slice on click, not create)"
        - "Clicking burst overlay selects the corresponding auto-created slice"
    - path: "src/components/viz/BurstList.tsx"
      provides: "Burst list as slice navigator (not creator)"
      changes:
        - "Remove addBurstSlice calls from burst list items"
        - "Clicking burst list item selects existing auto-created slice"
        - "Focus timeline to slice range on selection"
  key_links:
    - from: "Burst data computation/availability"
      to: "useSliceStore auto-creation effect"
      via: "useEffect or store subscription on burst windows change"
      pattern: "useEffect.*bursts|subscribe.*bursts"
    - from: "Burst overlay click"
      to: "setActiveSliceId"
      via: "select existing slice (not create)"
      pattern: "setActiveSliceId.*findMatchingSlice"
---

## Objective

Transform burst windows from "click-to-create slices" into "automatically existing slices." Burst windows should appear as slices without any user interaction.

**Purpose:** Close the UX gap — users shouldn't need to click burst windows to make them slices. They should just be slices from the moment they're computed/available.

**Output:** Automatic burst slice creation, with burst list and timeline overlays acting as slice navigators (not creators).

## Execution Context

@~/.opencode/get-shit-done/workflows/execute-plan.md
@~/.opencode/get-shit-done/templates/summary.md

## Context

@.planning/phases/29-remake-burstlist-as-first-class-slices/29-06-SUMMARY.md
@src/store/useSliceStore.ts
@src/components/timeline/DualTimeline.tsx
@src/components/viz/BurstList.tsx

### Current Behavior (from verification)
- Burst windows require clicking to create slices
- `addBurstSlice` called on burst list click and timeline overlay click
- Duplicate prevention via range matching

### Required Behavior
- Burst windows automatically become slices when burst data is available
- No user interaction required for slice creation
- Burst list items and timeline overlays select existing slices
- Burst computation/availability triggers automatic slice creation

## Tasks

<task type="auto">
  <name>Task 1: Add automatic burst slice creation effect</name>
  <files>src/store/useSliceStore.ts, src/components/timeline/DualTimeline.tsx</files>
  <action>
    Implement automatic burst-to-slice conversion when burst data becomes available:

    1. Open src/store/useSliceStore.ts

    2. Add a new effect/hook for automatic burst slice creation:
       - Create `useAutoBurstSlices` hook or similar
       - Subscribe to burst windows data (from adaptive store or burst computation)
       - When bursts change/compute, automatically call addBurstSlice for each burst window
       - Use existing addBurstSlice logic to handle reuse (no duplicates)

    3. Mount the effect in DualTimeline or appropriate parent component:
       - Import and use the auto-creation hook
       - Ensure it runs when component mounts and when bursts update
       - Should work silently in background

    4. Test that burst slices are created automatically:
       - Load timeline-test with burst data
       - Verify slices appear in SliceList without clicking
       - Verify burst chips show correctly

    5. Ensure no duplicates on re-renders:
       - addBurstSlice already has reuse logic via findMatchingSlice
       - Verify this prevents duplicates during effect re-runs
  </action>
  <verify>
    1. Build passes: `npm run build`
    2. Code review: Effect subscribes to burst data and auto-creates slices
    3. No TypeScript errors in modified files
  </verify>
  <done>
    - Automatic burst slice creation effect implemented
    - Burst slices appear automatically when data available
    - No duplicate slices created on re-renders
    - Build passes
  </done>
</task>

<task type="auto">
  <name>Task 2: Convert burst interactions from create to select</name>
  <files>src/components/timeline/DualTimeline.tsx, src/components/viz/BurstList.tsx</files>
  <action>
    Update burst interactions to select existing auto-created slices instead of creating new ones:

    1. Open src/components/timeline/DualTimeline.tsx

    2. Update burst overlay click handler:
       - Change from `addBurstSlice` (create) to selecting existing slice
       - Find matching slice using existing findMatchingSlice logic
       - Call setActiveSliceId with found slice id
       - Remove the create-new-slice path
       - Still focus timeline to slice range on click

    3. Update burst overlay rendering:
       - Keep burst window rects visible
       - onClick now selects existing slice (not creates)
       - Keep pointer-events for click handling

    4. Open src/components/viz/BurstList.tsx

    5. Update burst list item click handler:
       - Change from `addBurstSlice` (create) to selecting existing slice
       - Find matching slice using findMatchingSlice or store lookup
       - Call setActiveSliceId with found slice id
       - Focus timeline to slice range
       - Remove create-new-slice path

    6. Update burst list UI:
       - Items now represent existing slices
       - Visual styling remains (highlight when selected)
       - Click behavior: select + focus (not create)

    7. Test compile and build
  </action>
  <verify>
    1. Build passes: `npm run build`
    2. No TypeScript errors
    3. Code review: Click handlers use setActiveSliceId, not addBurstSlice
  </verify>
  <done>
    - Burst overlay clicks select existing slices
    - Burst list clicks select existing slices
    - Create-new-slice paths removed from UI handlers
    - Build passes
  </done>
</task>

<task type="auto">
  <name>Task 3: Verify end-to-end automatic behavior</name>
  <files>src/components/timeline/DualTimeline.tsx, src/components/viz/BurstList.tsx, src/app/timeline-test/components/SliceList.tsx</files>
  <action>
    Verify the automatic burst slice behavior works end-to-end:

    1. Run build checks: `npm run build`

    2. Verify code paths:
       - Auto-creation effect runs on burst data availability
       - Slices appear in store automatically
       - SliceList shows burst slices without user action
       - Burst list items select existing slices
       - Timeline overlays select existing slices
       - No manual click-to-create anywhere

    3. Verify edge cases:
       - Burst recomputation: reuse logic prevents duplicates
       - Burst slices can be deleted (and won't auto-recreate until next recompute)
       - Renamed burst slices: chip hidden, still auto-created with new name preserved
       - Manual slices: unaffected by burst auto-creation

    4. Document behavior change:
       - Burst windows = automatic slices
       - No user interaction required
       - Clicking selects existing slice

    5. Update any related tests if they expect click-to-create behavior
  </action>
  <verify>
    1. Build passes
    2. All automated checks pass
    3. Manual verification steps documented
  </verify>
  <done>
    - Burst slices appear automatically
    - Clicking burst selects existing slice (not creates)
    - All edge cases handled
    - Documentation updated
  </done>
</task>

## Verification

After completing all tasks:

1. **Automatic creation:** Load timeline-test with bursts → slices appear automatically in SliceList
2. **No click required:** Burst windows are already slices, no interaction needed for creation
3. **Select behavior:** Clicking burst overlay or list item selects existing slice
4. **No duplicates:** Recompute bursts → existing slices reused (not duplicated)
5. **Build passes:** No TypeScript errors, production build succeeds

## Success Criteria

- [ ] Burst slices created automatically when burst data available
- [ ] No user interaction required for burst-to-slice conversion
- [ ] Burst list items select existing slices (not create)
- [ ] Timeline burst overlays select existing slices (not create)
- [ ] Burst slice reuse logic prevents duplicates on recomputation
- [ ] Manual slices unaffected by changes
- [ ] Build passes with no errors
- [ ] No regression in existing slice functionality

## Output

After completion, create `.planning/phases/29-remake-burstlist-as-first-class-slices/29-07-SUMMARY.md` documenting:
- Automatic burst slice creation implementation
- Conversion from create to select behavior
- Verification of automatic behavior
- Edge case handling
