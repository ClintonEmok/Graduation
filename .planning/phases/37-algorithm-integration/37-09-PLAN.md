---
phase: 37-algorithm-integration
plan: 09
type: execute
wave: 1
depends_on: []
files_modified:
  - src/app/timeslicing/components/SuggestionPanel.tsx
  - src/app/timeslicing/components/SuggestionToolbar.tsx
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Toast notification appears on accept/reject"
    - "Filter suggestions by minimum confidence"
    - "Error state shown when generation fails"
  artifacts:
    - path: "src/app/timeslicing/components/SuggestionPanel.tsx"
      provides: "Toast notifications and confidence filter"
---

<objective>
Add feedback notifications, confidence filtering, and error handling.

Purpose: Improve user awareness of actions and allow filtering by suggestion quality.
</objective>

<context>
Current state:
- No feedback when accepting/rejecting
- All suggestions shown regardless of confidence
- No error display if generation fails

These are user experience improvements.
</context>

<tasks>

<task type="auto">
  <name>Add toast notifications for accept/reject actions</name>
  <files>src/app/timeslicing/components/SuggestionPanel.tsx, src/app/timeslicing/page.tsx</files>
  <action>
    Add user feedback via toast notifications:
    1. Use existing toast library (sonner) or add simple toast component
    2. On accept: show "Warp profile applied" or "Intervals created" toast
    3. On reject: show "Suggestion rejected" toast
    4. On undo: show "Action undone" toast
    5. Toasts auto-dismiss after 3 seconds
  </action>
  <verify>Toast appears after accept/reject</verify>
  <done>Users get feedback on their actions</done>
</task>

<task type="auto">
  <name>Add confidence filter</name>
  <files>src/app/timeslicing/components/SuggestionToolbar.tsx, src/app/timeslicing/components/SuggestionPanel.tsx</files>
  <action>
    Allow filtering by confidence:
    1. Add minimum confidence slider/filter to toolbar (0-100, default 0)
    2. Store filter value in suggestion store
    3. Filter displayed suggestions: only show those with confidence >= threshold
    4. Show filter badge: "Showing X of Y suggestions"
    5. Allow quick filters: "Show all", "High confidence (70+)"
  </action>
  <verify>Confidence filter reduces visible suggestions</verify>
  <done>Users can filter by confidence level</done>
</task>

<task type="auto">
  <name>Add error handling for generation failures</name>
  <files>src/hooks/useSuggestionGenerator.ts, src/app/timeslicing/components/SuggestionToolbar.tsx</files>
  <action>
    Handle generation errors gracefully:
    1. Wrap generation logic in try/catch
    2. On error: set error state in store
    3. Display error message in toolbar: "Generation failed: [reason]"
    4. Show retry button when error occurs
    5. Log error for debugging
  </action>
  <verify>Error message shown when generation fails</verify>
  <done>Users know when generation fails and can retry</done>
</task>

</tasks>

<verification>
- [ ] Toast notifications appear on actions
- [ ] Confidence filter works
- [ ] Error state shown on failure
</verification>

<success_criteria>
Feedback, filtering, and error handling implemented
</success_criteria>

<output>
After completion, create `.planning/phases/37-algorithm-integration/37-09-SUMMARY.md`
</output>
