---
phase: 37-algorithm-integration
plan: 04
type: execute
wave: 1
depends_on: []
files_modified:
  - src/store/useSuggestionStore.ts
  - src/app/timeslicing/components/SuggestionCard.tsx
  - src/app/timeslicing/components/SuggestionPanel.tsx
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Undo available for accept/reject actions"
    - "Keyboard shortcuts work (Enter accept, Escape cancel)"
    - "Processed section collapsible"
  artifacts:
    - path: "src/store/useSuggestionStore.ts"
      provides: "Undo state and actions"
---

<objective>
Improve interaction patterns - undo, keyboard shortcuts, and better organization.

Purpose: Make the UI more usable with common interaction patterns.
</objective>

<context>
Current state:
- No undo for accept/reject
- No keyboard shortcuts
- Processed suggestions always visible, can't hide

These are interaction improvements that make the UI more usable.
</context>

<tasks>

<task type="auto">
  <name>Add undo functionality for accept/reject</name>
  <files>src/store/useSuggestionStore.ts</files>
  <action>
    Implement undo capability:
    1. Add lastAction state to store: { id, type, previousStatus }
    2. Modify acceptSuggestion to store previous status before changing
    3. Add undoSuggestion action that reverts last action
    4. Add undo toast/notification with "Undo" button (or auto-undo within 5 seconds)
  </action>
  <verify>Accepting/rejecting shows undo option for 5 seconds</verify>
  <done>Users can undo recent accept/reject within 5 seconds</done>
</task>

<task type="auto">
  <name>Add keyboard shortcuts</name>
  <files>src/app/timeslicing/components/SuggestionCard.tsx</files>
  <action>
    Implement keyboard navigation:
    1. Add keyboard event handler in SuggestionCard
    2. Enter key: Accept suggestion (when card is focused/active)
    3. Escape key: Cancel editing or close panel
    4. Arrow keys: Navigate between suggestions
    5. Add visible hint: "Press Enter to accept" in card footer
  </action>
  <verify>Enter key accepts active suggestion, Escape cancels edit</verify>
  <done>Keyboard navigation works for power users</done>
</task>

<task type="auto">
  <name>Make processed suggestions collapsible</name>
  <files>src/app/timeslicing/components/SuggestionPanel.tsx</files>
  <action>
    Improve processed section organization:
    1. Add collapsed state for processed section
    2. Show "Processed (N)" with collapse toggle
    3. When collapsed: show count badge only, hide cards
    4. Persist collapse state in session
  </action>
  <verify>Clicking Processed header collapses/expands the section</verify>
  <done>Users can hide processed suggestions to focus on pending</done>
</task>

</tasks>

<verification>
- [ ] Undo button appears after accept/reject
- [ ] Keyboard shortcuts function
- [ ] Processed section collapsible
</verification>

<success_crases>
Interaction patterns improved: undo, keyboard, collapsible sections
</success_criteria>

<output>
After completion, create `.planning/phases/37-algorithm-integration/37-04-SUMMARY.md`
</output>
