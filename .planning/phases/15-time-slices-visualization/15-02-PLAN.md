---
phase: 15-time-slices
plan: 02
type: execute
wave: 2
depends_on:
  - 15-01
files_modified:
  - src/components/viz/SliceManagerUI.tsx
  - src/components/viz/FloatingToolbar.tsx
autonomous: true
must_haves:
  truths:
    - "User can open a Slice Manager panel"
    - "User can add new slices via UI"
    - "User can remove slices via UI"
    - "User can lock/unlock/hide slices"
  artifacts:
    - path: "src/components/viz/SliceManagerUI.tsx"
      provides: "Sidebar control panel for slices"
  key_links:
    - from: "src/components/viz/SliceManagerUI.tsx"
      to: "src/store/useSliceStore.ts"
      via: "store actions"
---

<objective>
Implement the User Interface for managing Time Slices.

Purpose: Give users control over slice creation, deletion, and properties without relying solely on 3D interaction.
Output: Functional "Layers/Slices" panel in the sidebar/toolbar.
</objective>

<execution_context>
@~/.opencode/get-shit-done/workflows/execute-plan.md
@~/.opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/15-time-slices/15-CONTEXT.md
@src/components/viz/FloatingToolbar.tsx
@src/store/useSliceStore.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Slice Manager UI</name>
  <files>src/components/viz/SliceManagerUI.tsx</files>
  <action>
    Create `SliceManagerUI.tsx`.
    
    Features:
    - Header: "Time Slices" with a "Generate" or "Add" button.
    - List of slices:
      - Display current time/date of the slice.
      - Controls per slice:
        - Visibility toggle (Eye icon).
        - Lock toggle (Lock icon).
        - Delete button (Trash icon).
      - Input field to manually edit the time value.
    - "Add Slice" button: Adds a slice at the current center time or default position.
    - "Clear All" button.
    
    Styling: Use standard project UI components (shadcn/ui buttons, inputs) and styling (Tailwind).
    Wrapper: It should likely be a panel that slides out or is part of a dialog/popover, similar to `FilterOverlay` or `SettingsPanel`.
    Given the `FloatingToolbar` structure, a `SlicePanel` (like `SettingsPanel`) is appropriate.
  </action>
  <verify>
    File exists and imports store.
  </verify>
  <done>UI component created.</done>
</task>

<task type="auto">
  <name>Task 2: Integrate into Floating Toolbar</name>
  <files>src/components/viz/FloatingToolbar.tsx</files>
  <action>
    Update `FloatingToolbar.tsx`:
    1. Import `SliceManagerUI`.
    2. Add state `isSlicePanelOpen`.
    3. Wire up the existing "Layers" button (Line 98) to toggle `isSlicePanelOpen`.
    4. Render `<SliceManagerUI isOpen={isSlicePanelOpen} onClose={() => setIsSlicePanelOpen(false)} />`.
  </action>
  <verify>
    `grep "SliceManagerUI" src/components/viz/FloatingToolbar.tsx` matches.
  </verify>
  <done>Layers button opens the slice manager.</done>
</task>

<task type="checkpoint:human-verify">
  <what-built>Time Slice UI and 3D rendering</what-built>
  <how-to-verify>
    1. Click "Layers" button in toolbar -> Slice panel should open.
    2. Click "Add Slice" -> A new slice should appear in the list AND in the 3D scene.
    3. Drag the slice in 3D -> Value in UI should update.
    4. Change value in UI -> Slice in 3D should move.
    5. Toggle Lock -> 3D slice should become immovable.
    6. Toggle Visibility -> 3D slice should disappear/reappear.
  </how-to-verify>
  <resume-signal>Type "approved" if UI and 3D sync works.</resume-signal>
</task>

</tasks>

<verification>
UI controls functional and synced with store.
</verification>

<success_criteria>
- User can manage slices via GUI.
- Changes in GUI reflect in 3D.
- Changes in 3D reflect in GUI.
</success_criteria>

<output>
After completion, create .planning/phases/15-time-slices/15-02-SUMMARY.md
</output>
